---
import Blogpost from '../../components/Blogpost.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
   const posts  =  await fetch(`http://localhost:1337/api/posts`).then(res => res.json())
   // console.log('first one', posts.data[0].attributes.slug);
   // ^^^this will log correctly^^^
      return posts.data.map(post => ({params : {slug:post.attributes.slug}}))
}

const {slug} = Astro.params;

const postItem = await fetch(`http://localhost:1337/api/posts?filters[slug][$eq]=${slug}`).then(res => res.json())
console.log("post item",postItem)
---

<BaseLayout title={postItem[0]?.title}>
<Blogpost />
</BaseLayout>